version: '3.9'
services:
  telemetry-api:
    build:
      dockerfile: Dockerfile
    command:
      ./node_modules/.bin/tsc-watch --project ./src/config/tsconfig.json --onSuccess "node /app/app/telemetry-api.js"
    environment:
      - PORT=8600
      - ENV_ID=dev
      - DD_ENV=dev
      - DD_PROFILING_ENABLED=true
      - INFLUXDB_HOST=influxdb
      - INFLUXDB_PORT=8086
      - INFLUXDB_DATABASE=beehive_metrics
      - INFLUXDB_TOKEN=O8_6qd5t_0ydiaQCZWJ_EjB177ByAdedTm8dW6SwX2nEb7AMN_MFk-gIDr_kS9Ym_kDY3CHXi3sz6Iuv-an12A==
    tty: true
    ports:
      - 8600:8600
    volumes:
      - .:/app/
    restart: always
    network_mode: bridge
    networks:
      - gratheon
networks:
  gratheon: